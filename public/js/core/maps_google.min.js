

function initialize(){
    var geocoder;
    var gmarkers    = [];
    geocoder        = new google.maps.Geocoder();
    var latlng      = new google.maps.LatLng(-6.166637137056789, 106.83066570555218);
    var map     = new google.maps.Map(document.getElementById('js-map-search'), {
                center: latlng,
                zoom: 13,
                mapTypeId: google.maps.MapTypeId.ROADMAP
    });

    var marker  = new google.maps.Marker({
                position: latlng,
                map: map,
                title: 'Set lat/lon values for this property',
                draggable: true
    });

    gmarkers.push(marker);

    google.maps.event.addListener(marker, 'dragend', function(a) {
                console.log(a);
                var div = document.createElement('div');
                div.innerHTML = a.latLng.lat().toFixed(4) + ', ' + a.latLng.lng().toFixed(4);
                document.getElementsByTagName('body')[0].appendChild(div);
    });

    google.maps.event.addListener(map,'click',function(event) {
                document.getElementById('latitude').value = event.latLng.lat();
                document.getElementById('longitude').value = event.latLng.lng();
                placeMarker(event.latLng);
                getAddress(event.latLng);
    });

    function placeMarker(location) { 
        for (var i = 0; i < gmarkers.length; i++) {
            gmarkers[i].setMap(null);
        }
        gmarkers = [];
        var marker = new google.maps.Marker({  
            position: location,  
            map: map  
        });
        gmarkers.push(marker);
    }

    function getAddress(latLng) {
        geocoder.geocode( {'latLng': latLng},
            function(results, status) {
                if(status == google.maps.GeocoderStatus.OK) {
                    if(results[0]) {
                        //set center;
                        map.setCenter(results[0].geometry.location);
                        document.getElementById("lokasi").value = results[0].formatted_address;
                    }else {
                        document.getElementById("lokasi").value = "No results";
                    }
                }
            else {
                document.getElementById("lokasi").value = status;
            }
        });
    }

    $('#searchInput').change(function(e){
        var address = document.getElementById("searchInput").value;
        geocoder.geocode(  {'address': address},
            function(results, status) {
                if(status == google.maps.GeocoderStatus.OK) {
                    map.setCenter(results[0].geometry.location);
                }
        });
    });   

}

